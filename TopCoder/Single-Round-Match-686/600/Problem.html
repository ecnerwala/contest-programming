<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
The <i>level-M weight of a permutation P</i>, denoted W(P,M), is computed by finding the number of cycles of P and then taking that number to the M-th power.
For example, the level-3 weight of a permutation with 5 cycles is 5^3.
</p>
<p>
The <i>total level-M weight of all permutations on N elements</i>, denoted T(N,M), is computed as the sum of W(P,M) over all N! possible permutations P on N elements.
</p>
<p>
You are given multiple queries.
These are encoded as two vector &lt;int&gt;s <b>n</b> and <b>m</b> with the same number of elements.
Return a vector &lt;int&gt; with the same number of elements as <b>n</b>.
For each valid i, element i of the return value should be the value T( <b>n</b>[i], <b>m</b>[i] ) modulo 1,000,000,007.
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>CyclesNumber</td></tr><tr><td>Method:</td><td>getExpectation</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>vector &lt;int&gt;</td></tr><tr><td>Method signature:</td><td>vector &lt;int&gt; getExpectation(vector &lt;int&gt; n, vector &lt;int&gt; m)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Formally, a permutation on N elements is a bijective function P defined on an N-element set S.</td></tr><tr><td align="center" valign="top">-</td><td>A cycle of a permutation is a sequence c[0], c[1], ..., c[k-1] of distinct elements of S such that for each i, P(c[i]) = c[(i+1) mod k].</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> and <b>m</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will contain between 1 and 300 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>n</b> will be between 1 and 100,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>m</b> will be between 0 and 300, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2}</pre></td></tr><tr><td><pre>{2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {5 }</pre></td></tr><tr><td><table><tr><td colspan="2">Here are two permutations: (1, 2) and (2, 1). (1, 2) have 2 cycles. (2, 1) has one cycle. So answer is 1 * 1 + 2 * 2 = 5.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{3}</pre></td></tr><tr><td><pre>{0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {6 }</pre></td></tr><tr><td><table><tr><td colspan="2">Here answer is just number of permutations, 3! = 6.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 2, 3}</pre></td></tr><tr><td><pre>{1, 3, 3}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {1, 9, 53 }</pre></td></tr><tr><td><table><tr><td colspan="2">Could be more than one query.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{10, 20, 30}</pre></td></tr><tr><td><pre>{10, 20, 30}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {586836447, 544389755, 327675273 }</pre></td></tr><tr><td><table><tr><td colspan="2">Do not forget take answers modulo 1,000,000,007.</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>